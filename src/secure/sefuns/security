/// @addtogroup sefun
/// @{
/// @file security
/// @brief security related simul_efuns
/// @author Gwenhwyvar
/// @version 0.0.0
/// @date 2016-01-24

// getgid {{{
// --------------------------------------------------------------------------
/// @brief getgid 
/// 
/// @Param who - defaults to this_object()
/// @Returns real group id
// --------------------------------------------------------------------------
public string getgid(mixed who = 0)
{
    if(!who)
        who = TO();

    return explode(efun::getuid(who), ":")[1];
}
// }}}
// getegid {{{
// --------------------------------------------------------------------------
/// @brief getegid 
/// 
/// @Param who - defaults to this_object()
/// @Returns effective group id
// --------------------------------------------------------------------------
public string getegid(mixed who = 0)
{
    string ret;

    if(!who)
        who = TO();

    ret = efun::geteuid(who);
    if(!ret)
        return UNKNOWN_DOMAIN;
    else
        return explode(ret, ":")[1];
}
// }}}
// setegid {{{
// --------------------------------------------------------------------------
/// @brief setegid 
/// 
/// @Param gid
/// @Returns 1 if successfully set, 0 otherwise
// --------------------------------------------------------------------------
public int setegid(string egid)
{
    object    who = TO();
    function    f = bind( (: efun::seteuid :), who);
    string    arg = geteuid(who) + ":" + egid;

    return (*f)(arg);
}
// }}}
// getuid {{{
// --------------------------------------------------------------------------
/// @brief getuid 
/// 
/// @Param who - defaults to this_object()
/// @Returns real user id
// --------------------------------------------------------------------------
public string getuid(mixed who = 0)
{
    if(!who)
        who = TO();

    return explode(efun::getuid(who), ":")[0];
}
// }}}
// geteuid {{{
// --------------------------------------------------------------------------
/// @brief geteuid 
/// 
/// @Param who - defaults to this_object()
/// @Returns effective user id
// --------------------------------------------------------------------------
public string geteuid(mixed who = 0)
{
    string ret;

    if(!who)
        who = TO();

    ret = efun::geteuid(who);
    if(!ret)
        return UNKNOWN_UID;
    else
        return explode(ret, ":")[0];
}
// }}}
// seteuid {{{
// --------------------------------------------------------------------------
/// @brief seteuid 
/// 
/// @Param euid
/// @Returns 1 if successfully set, 0 otherwise
// --------------------------------------------------------------------------
public int seteuid(string euid)
{
    object    who = TO();
    function    f = bind( (: efun::seteuid :), who);
    string    arg = euid + ":" + getegid(who);;

    return (*f)(arg);
}
// }}}
// init_eids {{{
// --------------------------------------------------------------------------
/// @brief init_eids 
///
/// This function must be called within each object that wants to do any
/// security relevant action (e.g. read/write files, clone other objects, ...)
/// @Returns 1 if successfully set, 0 otherwise
// --------------------------------------------------------------------------
public int init_eteids(void)
{
    object   who = TO();
    function   f = bind( (: efun::seteuid :), who);

    return (*f)(efun::getuid(who));
}
// }}}
///  @}
